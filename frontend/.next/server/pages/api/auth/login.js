"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/auth/login";
exports.ids = ["pages/api/auth/login"];
exports.modules = {

/***/ "(api)/./pages/api/auth/login.ts":
/*!*********************************!*\
  !*** ./pages/api/auth/login.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\nconst API_URL = \"http://localhost:8000/api/v1\" || 0;\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            message: \"Method not allowed\"\n        });\n    }\n    try {\n        const { email , password  } = req.body;\n        if (!email || !password) {\n            return res.status(400).json({\n                message: \"Email and password are required\"\n            });\n        }\n        const form = new URLSearchParams({\n            username: email,\n            password\n        });\n        const upstream = await fetch(`${API_URL}/auth/token`, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\n            },\n            body: form\n        });\n        if (!upstream.ok) {\n            const msg = await upstream.text();\n            return res.status(upstream.status).json({\n                message: msg || \"Login failed\"\n            });\n        }\n        const data = await upstream.json();\n        // Ensure required fields exist; default to empty strings\n        const response = {\n            token: data.token || data.access_token || \"\",\n            user: {\n                id: data.user?.id || \"\",\n                email: data.user?.email || email,\n                full_name: data.user?.full_name || \"\",\n                role: data.user?.role || \"client\"\n            }\n        };\n        return res.status(200).json(response);\n    } catch (error) {\n        console.error(\"Login error:\", error);\n        return res.status(500).json({\n            message: \"Internal server error\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvYXV0aC9sb2dpbi50cy5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBaUJBLE1BQU1BLFVBQVVDLDhCQUErQixJQUFJO0FBRXBDLGVBQWVHLFFBQzVCQyxHQUFtQixFQUNuQkMsR0FBeUQsRUFDekQ7SUFDQSxJQUFJRCxJQUFJRSxNQUFNLEtBQUssUUFBUTtRQUN6QixPQUFPRCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLFNBQVM7UUFBcUI7SUFDOUQsQ0FBQztJQUVELElBQUk7UUFDRixNQUFNLEVBQUVDLE1BQUssRUFBRUMsU0FBUSxFQUFFLEdBQWNQLElBQUlRLElBQUk7UUFFL0MsSUFBSSxDQUFDRixTQUFTLENBQUNDLFVBQVU7WUFDdkIsT0FBT04sSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsU0FBUztZQUFrQztRQUMzRSxDQUFDO1FBRUQsTUFBTUksT0FBTyxJQUFJQyxnQkFBZ0I7WUFBRUMsVUFBVUw7WUFBT0M7UUFBUztRQUM3RCxNQUFNSyxXQUFXLE1BQU1DLE1BQU0sQ0FBQyxFQUFFbEIsUUFBUSxXQUFXLENBQUMsRUFBRTtZQUNwRE8sUUFBUTtZQUNSWSxTQUFTO2dCQUFFLGdCQUFnQjtZQUFvQztZQUMvRE4sTUFBTUM7UUFDUjtRQUVBLElBQUksQ0FBQ0csU0FBU0csRUFBRSxFQUFFO1lBQ2hCLE1BQU1DLE1BQU0sTUFBTUosU0FBU0ssSUFBSTtZQUMvQixPQUFPaEIsSUFBSUUsTUFBTSxDQUFDUyxTQUFTVCxNQUFNLEVBQUVDLElBQUksQ0FBQztnQkFBRUMsU0FBU1csT0FBTztZQUFlO1FBQzNFLENBQUM7UUFFRCxNQUFNRSxPQUFPLE1BQU1OLFNBQVNSLElBQUk7UUFFaEMseURBQXlEO1FBQ3pELE1BQU1lLFdBQTBCO1lBQzlCQyxPQUFPRixLQUFLRSxLQUFLLElBQUlGLEtBQUtHLFlBQVksSUFBSTtZQUMxQ0MsTUFBTTtnQkFDSkMsSUFBSUwsS0FBS0ksSUFBSSxFQUFFQyxNQUFNO2dCQUNyQmpCLE9BQU9ZLEtBQUtJLElBQUksRUFBRWhCLFNBQVNBO2dCQUMzQmtCLFdBQVdOLEtBQUtJLElBQUksRUFBRUUsYUFBYTtnQkFDbkNDLE1BQU1QLEtBQUtJLElBQUksRUFBRUcsUUFBUTtZQUMzQjtRQUNGO1FBRUEsT0FBT3hCLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUNlO0lBQzlCLEVBQUUsT0FBT08sT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsZ0JBQWdCQTtRQUM5QixPQUFPekIsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxTQUFTO1FBQXdCO0lBQ2pFO0FBQ0YsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL21hcmtldHBsYWNlLWZyb250ZW5kLy4vcGFnZXMvYXBpL2F1dGgvbG9naW4udHM/NzQ0ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0J1xyXG5cclxudHlwZSBMb2dpbkRhdGEgPSB7XHJcbiAgZW1haWw6IHN0cmluZ1xyXG4gIHBhc3N3b3JkOiBzdHJpbmdcclxufVxyXG5cclxudHlwZSBMb2dpblJlc3BvbnNlID0ge1xyXG4gIHRva2VuOiBzdHJpbmdcclxuICB1c2VyOiB7XHJcbiAgICBpZDogc3RyaW5nXHJcbiAgICBlbWFpbDogc3RyaW5nXHJcbiAgICBmdWxsX25hbWU6IHN0cmluZ1xyXG4gICAgcm9sZTogc3RyaW5nXHJcbiAgfVxyXG59XHJcblxyXG5jb25zdCBBUElfVVJMID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBJX1VSTCB8fCAnaHR0cDovL2xvY2FsaG9zdDo4MDAwL2FwaS92MSdcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIoXHJcbiAgcmVxOiBOZXh0QXBpUmVxdWVzdCxcclxuICByZXM6IE5leHRBcGlSZXNwb25zZTxMb2dpblJlc3BvbnNlIHwgeyBtZXNzYWdlOiBzdHJpbmcgfT5cclxuKSB7XHJcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgbWVzc2FnZTogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSlcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGVtYWlsLCBwYXNzd29yZCB9OiBMb2dpbkRhdGEgPSByZXEuYm9keVxyXG5cclxuICAgIGlmICghZW1haWwgfHwgIXBhc3N3b3JkKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6ICdFbWFpbCBhbmQgcGFzc3dvcmQgYXJlIHJlcXVpcmVkJyB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGZvcm0gPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHsgdXNlcm5hbWU6IGVtYWlsLCBwYXNzd29yZCB9KVxyXG4gICAgY29uc3QgdXBzdHJlYW0gPSBhd2FpdCBmZXRjaChgJHtBUElfVVJMfS9hdXRoL3Rva2VuYCwge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcgfSxcclxuICAgICAgYm9keTogZm9ybSxcclxuICAgIH0pXHJcblxyXG4gICAgaWYgKCF1cHN0cmVhbS5vaykge1xyXG4gICAgICBjb25zdCBtc2cgPSBhd2FpdCB1cHN0cmVhbS50ZXh0KClcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXModXBzdHJlYW0uc3RhdHVzKS5qc29uKHsgbWVzc2FnZTogbXNnIHx8ICdMb2dpbiBmYWlsZWQnIH0pXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHVwc3RyZWFtLmpzb24oKVxyXG5cclxuICAgIC8vIEVuc3VyZSByZXF1aXJlZCBmaWVsZHMgZXhpc3Q7IGRlZmF1bHQgdG8gZW1wdHkgc3RyaW5nc1xyXG4gICAgY29uc3QgcmVzcG9uc2U6IExvZ2luUmVzcG9uc2UgPSB7XHJcbiAgICAgIHRva2VuOiBkYXRhLnRva2VuIHx8IGRhdGEuYWNjZXNzX3Rva2VuIHx8ICcnLFxyXG4gICAgICB1c2VyOiB7XHJcbiAgICAgICAgaWQ6IGRhdGEudXNlcj8uaWQgfHwgJycsXHJcbiAgICAgICAgZW1haWw6IGRhdGEudXNlcj8uZW1haWwgfHwgZW1haWwsXHJcbiAgICAgICAgZnVsbF9uYW1lOiBkYXRhLnVzZXI/LmZ1bGxfbmFtZSB8fCAnJyxcclxuICAgICAgICByb2xlOiBkYXRhLnVzZXI/LnJvbGUgfHwgJ2NsaWVudCcsXHJcbiAgICAgIH0sXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3BvbnNlKVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdMb2dpbiBlcnJvcjonLCBlcnJvcilcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0pXHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJBUElfVVJMIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX0FQSV9VUkwiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJlbWFpbCIsInBhc3N3b3JkIiwiYm9keSIsImZvcm0iLCJVUkxTZWFyY2hQYXJhbXMiLCJ1c2VybmFtZSIsInVwc3RyZWFtIiwiZmV0Y2giLCJoZWFkZXJzIiwib2siLCJtc2ciLCJ0ZXh0IiwiZGF0YSIsInJlc3BvbnNlIiwidG9rZW4iLCJhY2Nlc3NfdG9rZW4iLCJ1c2VyIiwiaWQiLCJmdWxsX25hbWUiLCJyb2xlIiwiZXJyb3IiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/auth/login.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/auth/login.ts"));
module.exports = __webpack_exports__;

})();